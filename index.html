girl in pink sports and  white small shorts leggy wet in a swimming pool sitting on side of a pool pose stunnig looks and hand in water in  the water <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9:16 Image Converter with AI Captions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- JSZip library for creating zip files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .dotted-border {
            border-style: dashed;
        }
        .caption-content {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
    </style>
</head>
<body class="bg-slate-900 text-white flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl mx-auto">
        <div class="bg-slate-800 rounded-2xl p-6 sm:p-8 shadow-2xl">
            <div class="text-center">
                <h1 class="text-2xl sm:text-3xl font-bold text-cyan-400">9:16 Image Converter</h1>
                <p class="text-slate-400 mt-2">Create perfect story-sized images with AI-powered captions.</p>
            </div>

            <!-- Image Upload Section -->
            <div id="upload-container" class="mt-8">
                <label for="image-upload" class="flex flex-col items-center justify-center w-full h-48 sm:h-64 border-2 border-slate-600 dotted-border rounded-xl cursor-pointer hover:bg-slate-700 transition-colors">
                    <div class="flex flex-col items-center justify-center pt-5 pb-6">
                        <svg class="w-10 h-10 mb-3 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                        <p class="mb-2 text-sm text-slate-400"><span class="font-semibold">Click to upload</span> or drag and drop</p>
                        <p class="text-xs text-slate-500">Upload up to 6 images (PNG, JPG, WEBP)</p>
                    </div>
                    <input id="image-upload" type="file" class="hidden" accept="image/png, image/jpeg, image/webp" multiple />
                </label>
            </div>

            <!-- Results Section -->
            <div id="result-container" class="mt-6 hidden">
                 <!-- Mode Selector -->
                <div class="flex items-center justify-center space-x-4 sm:space-x-6 mb-4">
                    <label class="flex items-center cursor-pointer">
                        <input type="radio" name="mode" value="fit" class="peer sr-only" checked>
                        <span class="px-4 py-2 text-sm sm:text-base font-medium text-slate-300 rounded-md peer-checked:bg-cyan-500 peer-checked:text-slate-900 transition-colors">Fit with Blur</span>
                    </label>
                    <label class="flex items-center cursor-pointer">
                        <input type="radio" name="mode" value="fill" class="peer sr-only">
                        <span class="px-4 py-2 text-sm sm:text-base font-medium text-slate-300 rounded-md peer-checked:bg-cyan-500 peer-checked:text-slate-900 transition-colors">Fill and Crop</span>
                    </label>
                </div>
                <p id="loading-message" class="text-center text-slate-400 mb-4 hidden">Processing your images...</p>
                <!-- Container for multiple canvases -->
                <div id="canvas-container" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>
                
                <div class="mt-8 flex flex-col sm:flex-row gap-4">
                     <button id="download-btn" class="w-full bg-cyan-500 hover:bg-cyan-600 text-slate-900 font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:ring-opacity-75">
                        Download All (.zip)
                    </button>
                    <button id="new-upload-btn" class="w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-3 px-4 rounded-lg transition-colors">
                        Upload Others
                    </button>
                </div>
            </div>
        </div>
        <footer class="text-center mt-6">
            <p class="text-sm text-slate-500">AI features powered by Him</p>
        </footer>
    </div>

    <script>
        const uploadContainer = document.getElementById('upload-container');
        const resultContainer = document.getElementById('result-container');
        const imageUpload = document.getElementById('image-upload');
        const downloadBtn = document.getElementById('download-btn');
        const newUploadBtn = document.getElementById('new-upload-btn');
        const canvasContainer = document.getElementById('canvas-container');
        const loadingMessage = document.getElementById('loading-message');
        
        let currentImages = []; // Store the loaded image objects

        // --- Drag and Drop functionality ---
        const dropArea = uploadContainer.querySelector('label');
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false);
        });
        ['dragenter', 'dragover'].forEach(eventName => dropArea.addEventListener(eventName, () => dropArea.classList.add('bg-slate-700'), false));
        ['dragleave', 'drop'].forEach(eventName => dropArea.addEventListener(eventName, () => dropArea.classList.remove('bg-slate-700'), false));
        dropArea.addEventListener('drop', handleDrop, false);

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        function handleDrop(e) {
            const dt = e.dataTransfer;
            if (dt.files.length > 0) handleFiles(dt.files);
        }

        imageUpload.addEventListener('change', (e) => {
            if (e.target.files && e.target.files.length > 0) handleFiles(e.target.files);
        });

        function handleFiles(files) {
            const filesToProcess = Array.from(files).slice(0, 6);
            const imagePromises = filesToProcess.map(file => {
                return new Promise((resolve) => {
                    if (!file.type.startsWith('image/')) { resolve(null); return; }
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const img = new Image();
                        img.onload = () => resolve({img: img, type: file.type});
                        img.onerror = () => resolve(null);
                        img.src = event.target.result;
                    };
                    reader.onerror = () => resolve(null);
                    reader.readAsDataURL(file);
                });
            });

            uploadContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');
            loadingMessage.classList.remove('hidden');
            canvasContainer.innerHTML = '';
            document.querySelector('input[name="mode"][value="fit"]').checked = true;

            Promise.all(imagePromises).then(results => {
                currentImages = results.filter(r => r !== null);
                renderAllImages('fit');
                loadingMessage.classList.add('hidden');
            }).catch(error => {
                console.error("Error loading images:", error);
                loadingMessage.innerText = "Error loading one or more images.";
            });
        }
        
        function renderAllImages(mode) {
            canvasContainer.innerHTML = ''; 
            currentImages.forEach((imgData, index) => {
                const wrapper = document.createElement('div');
                wrapper.className = 'bg-slate-700/50 p-3 rounded-xl flex flex-col gap-3';

                const canvas = document.createElement('canvas');
                canvas.className = 'w-full rounded-lg shadow-md';
                canvas.id = `canvas-${index}`;
                
                const captionButton = document.createElement('button');
                captionButton.innerHTML = `âœ¨ Suggest Captions`;
                captionButton.className = 'w-full bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-400';
                captionButton.onclick = () => getCaptionFromGemini(canvas, imgData.type, `caption-result-${index}`);

                const captionResultDiv = document.createElement('div');
                captionResultDiv.id = `caption-result-${index}`;
                captionResultDiv.className = 'w-full p-3 bg-slate-800 rounded-lg text-sm text-slate-300 hidden caption-content';
                
                wrapper.appendChild(canvas);
                wrapper.appendChild(captionButton);
                wrapper.appendChild(captionResultDiv);
                canvasContainer.appendChild(wrapper);

                processImage(imgData.img, mode, canvas);
            });
        }

        function processImage(img, mode, canvas) {
            if (!img || !canvas) return;
            const ctx = canvas.getContext('2d');
            const aspectRatio = 9 / 16;
            const outputHeight = 1920; 
            const outputWidth = outputHeight * aspectRatio;
            canvas.width = outputWidth;
            canvas.height = outputHeight;
            ctx.clearRect(0, 0, canvas.width, canvas.height); 

            const imageAspectRatio = img.width / img.height;
            if (mode === 'fit') {
                ctx.filter = 'blur(25px) brightness(0.7)';
                ctx.drawImage(img, 0, 0, outputWidth, outputHeight);
                ctx.filter = 'none';
                let drawWidth, drawHeight, x, y;
                if (imageAspectRatio > aspectRatio) {
                    drawWidth = outputWidth;
                    drawHeight = drawWidth / imageAspectRatio;
                } else {
                    drawHeight = outputHeight;
                    drawWidth = drawHeight * imageAspectRatio;
                }
                x = (outputWidth - drawWidth) / 2;
                y = (outputHeight - drawHeight) / 2;
                ctx.drawImage(img, x, y, drawWidth, drawHeight);
            } else if (mode === 'fill') {
                let sx = 0, sy = 0, sWidth = img.width, sHeight = img.height;
                if (imageAspectRatio > aspectRatio) {
                    sWidth = sHeight * aspectRatio;
                    sx = (img.width - sWidth) / 2;
                } else {
                    sHeight = sWidth / aspectRatio;
                    sy = (img.height - sHeight) / 2;
                }
                ctx.drawImage(img, sx, sy, sWidth, sHeight, 0, 0, outputWidth, outputHeight);
            }
        }

        async function getCaptionFromGemini(canvas, mimeType, resultDivId) {
            const resultElement = document.getElementById(resultDivId);
            resultElement.classList.remove('hidden');
            resultElement.innerText = 'âœ¨ Thinking of creative captions...';

            const dataUrl = canvas.toDataURL(mimeType);
            const base64Data = dataUrl.split(',')[1];
            
            const apiKey = ""; // Will be provided by the environment
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{
                    parts: [
                        { text: "You are a witty and creative social media expert. Analyze this image and provide 3 engaging caption ideas and a list of 5 relevant hashtags. Format the response clearly with headings, like '--- Captions ---' and '--- Hashtags ---'." },
                        { inlineData: { mimeType: mimeType, data: base64Data } }
                    ]
                }],
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.statusText}`);
                }

                const result = await response.json();
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    resultElement.innerText = candidate.content.parts[0].text;
                } else {
                    throw new Error("No content found in API response.");
                }
            } catch (error) {
                console.error("Gemini API call failed:", error);
                resultElement.innerText = "Sorry, couldn't generate captions. Please try again.";
            }
        }

        document.querySelectorAll('input[name="mode"]').forEach(radio => {
            radio.addEventListener('change', (event) => renderAllImages(event.target.value));
        });
        
        downloadBtn.addEventListener('click', () => {
            if (typeof JSZip === 'undefined') { console.error("JSZip library not loaded!"); return; }
            const zip = new JSZip();
            const canvases = canvasContainer.querySelectorAll('canvas');
            const selectedMode = document.querySelector('input[name="mode"]:checked').value;

            canvases.forEach((canvas, index) => {
                const dataUrl = canvas.toDataURL('image/png');
                const base64Data = dataUrl.split(',')[1];
                zip.file(`converted-9x16-${selectedMode}-${index + 1}.png`, base64Data, {base64: true});
            });

            zip.generateAsync({type:"blob"}).then(function(content) {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(content);
                link.download = "converted-images.zip";
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });
        });

        newUploadBtn.addEventListener('click', () => {
            uploadContainer.classList.remove('hidden');
            resultContainer.classList.add('hidden');
            imageUpload.value = ''; 
            currentImages = [];
            canvasContainer.innerHTML = '';
        });
    </script>
</body>
</html>

